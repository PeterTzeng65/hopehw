<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAYI æ»¿æº¢èŒ¶é£² - å…¬å¸åœ˜è³¼ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .form-section {
            padding: 30px;
        }
        
        .customer-info {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .order-section {
            background: #f0f8e8;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .order-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .add-item-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }
        
        .add-item-btn:hover {
            background: #218838;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quantity-btn {
            background: #667eea;
            color: white;
            border: none;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s;
        }
        
        .quantity-btn:hover {
            background: #5a6fd8;
        }
        
        .quantity-input {
            width: 60px;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }
        
        .price-display {
            font-weight: bold;
            font-size: 1.1em;
            color: #ff6b6b;
            min-width: 80px;
        }
        
        .remove-btn {
            background: #dc3545;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }
        
        .remove-btn:hover {
            background: #c82333;
        }
        
        .summary-section {
            background: linear-gradient(45deg, #48c9b0, #16a085);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .summary-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .order-list {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }
        
        .summary-item:last-child {
            border-bottom: none;
        }
        
        .total-price {
            font-size: 1.8em;
            font-weight: bold;
            text-align: center;
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
        }
        
        .submit-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 1.3em;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: transform 0.3s;
            min-width: 250px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
        }
        
        .submit-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§‹ MAYI æ»¿æº¢èŒ¶é£²</h1>
            <p>å…¬å¸åœ˜è³¼è¨‚è³¼ç³»çµ± - å€‹åˆ¥å®¢è£½åŒ–ç‰ˆ</p>
        </div>
        
        <div class="form-section">
            <!-- å®¢æˆ¶è³‡è¨Š -->
            <div class="customer-info">
                <h3 style="margin-bottom: 20px; color: #333;">ğŸ‘¤ è¨‚è³¼è€…è³‡è¨Š</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="customerName">è¨‚è³¼è€…å§“å/çµ„åˆ¥åç¨±</label>
                        <input type="text" id="customerName" placeholder="ä¾‹å¦‚ï¼šç‹å°æ˜ã€è²¡å‹™éƒ¨ã€ç ”ç™¼çµ„">
                    </div>
                    <div class="form-group">
                        <label for="customerContact">è¯çµ¡æ–¹å¼</label>
                        <input type="text" id="customerContact" placeholder="åˆ†æ©Ÿæˆ–æ‰‹æ©Ÿè™Ÿç¢¼">
                    </div>
                </div>
            </div>
            
            <!-- æç¤ºèªªæ˜ -->
            <div style="background: #e8f4fd; padding: 20px; border-radius: 10px; margin-bottom: 30px; text-align: center;">
                <h3 style="color: #333; margin-bottom: 10px;">ğŸ’¡ ä½¿ç”¨èªªæ˜</h3>
                <p style="color: #666; margin: 0;">æ¯ç­†é£²æ–™éƒ½å¯ä»¥å€‹åˆ¥è¨­å®šå†°å¡Šã€ç³–åˆ†ã€å¥¶é‡ç¨‹åº¦ï¼Œè®“æ¯å€‹äººéƒ½èƒ½å®¢è£½åŒ–è‡ªå·±å–œæ­¡çš„å£å‘³ï¼</p>
            </div>
            
            <!-- è¨‚è³¼å€åŸŸ -->
            <div class="order-section">
                <h3 style="margin-bottom: 20px; color: #333;">ğŸ›’ é¸æ“‡é£²æ–™</h3>
                <button class="add-item-btn" onclick="addOrderItem()">+ æ–°å¢é£²æ–™</button>
                <div id="orderItems"></div>
            </div>
            
            <!-- è¨‚å–®æ‘˜è¦ -->
            <div class="summary-section">
                <div class="summary-title">ğŸ“‹ è¨‚å–®æ‘˜è¦</div>
                <div class="order-list" id="orderSummary">
                    <div style="text-align: center; opacity: 0.7;">å°šæœªé¸æ“‡ä»»ä½•é£²æ–™</div>
                </div>
                <div class="total-price" id="totalPrice">ç¸½è¨ˆï¼š$0</div>
            </div>
            
            <!-- å‚™è¨» -->
            <div class="form-group" style="margin-bottom: 30px;">
                <label for="customerNotes">ğŸ“ å‚™è¨»</label>
                <textarea id="customerNotes" rows="3" placeholder="ç‰¹æ®Šéœ€æ±‚æˆ–å‚™è¨»äº‹é …"></textarea>
            </div>
            
            <button class="submit-btn" id="submitBtn" onclick="submitOrder()">
                ğŸš€ é€å‡ºåœ˜è³¼è¨‚å–®
            </button>
            
            <!-- èœå–®åœ–ç‰‡å€åŸŸ -->
            <div style="margin-top: 40px; text-align: center;">
                <h3 style="color: #333; margin-bottom: 20px;">ğŸ“‹ MAYI æ»¿æº¢èŒ¶é£²å®Œæ•´èœå–®</h3>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <img src="MAYI.jpg" 
                         alt="MAYI æ»¿æº¢èŒ¶é£²èœå–®" 
                         style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
                    <p style="margin-top: 15px; color: #666; font-size: 0.9em;">
                        ğŸ’¡ åƒè€ƒå®Œæ•´èœå–®é¸æ“‡æ‚¨å–œæ­¡çš„é£²æ–™ï¼Œæ¯ç¨®é£²æ–™éƒ½å¯ä»¥å€‹åˆ¥å®¢è£½åŒ–å†°å¡Šã€ç³–åˆ†ã€å¥¶é‡ç¨‹åº¦ï¼
                    </p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // é£²æ–™èœå–®è³‡æ–™
        const drinkCategories = {
            'æ‰¾å¥¶èŒ¶': [
                {name: 'å¯å¯é¢¨å‘³å¥¶èŒ¶', sizes: [{size: 'M', price: 50}, {size: 'L', price: 60}]},
                {name: 'ä»™è‰å‡å¥¶èŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 50}]},
                {name: 'èŒ‰è‰å¥¶ç¶ ', sizes: [{size: 'M', price: 45}, {size: 'L', price: 50}]},
                {name: 'æ»¿æº¢çƒ¤é¦™å¥¶èŒ¶', sizes: [{size: 'M', price: 50}, {size: 'L', price: 55}]},
                {name: 'æ»¿æº¢çç å¥¶èŒ¶', sizes: [{size: 'M', price: 50}, {size: 'L', price: 55}]},
                {name: 'ç‚­ç‡’çƒé¾å¥¶èŒ¶', sizes: [{size: 'M', price: 50}, {size: 'L', price: 55}]},
                {name: 'å¸ƒä¸ä¼¯çˆµå¥¶èŒ¶', sizes: [{size: 'M', price: 50}, {size: 'L', price: 60}]},
                {name: 'å¯å¯ç’°æœå¥¶', sizes: [{size: 'M', price: 60}, {size: 'L', price: 65}]},
                {name: 'æ‰‹ç‚’é»‘ç³–éµè§€éŸ³å¥¶', sizes: [{size: 'M', price: 60}, {size: 'L', price: 75}]}
            ],
            'æ‰¾å£æ‰': [
                {name: 'åŸèƒç¶“å…¸åŸèŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 30}]},
                {name: 'åš´å…¸ä¼¯çˆµç´…èŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 30}]},
                {name: 'ç†±å¸¶é†‡é¦™ç´…èŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 30}]},
                {name: 'èŒ‰è‰åŸèƒç¶ èŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 30}]},
                {name: 'ç‚­ç„™é«˜å±±çƒé¾èŒ¶', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 35}]},
                {name: 'é’é€¸å››å­£æ˜¥', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 35}]},
                {name: 'èœœæŸšé«˜éº—ç¶ ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 35}]}
            ],
            'æ‰¾çƒå‘³': [
                {name: 'åš´é¸é›²å—æ˜†æ˜èŒ¶å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'èŒ‰è‰åŸèƒç¶ èŒ¶å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'èœœæŸšé«˜éº—ç¶ èŒ¶å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'ç‚­ç„™é«˜å±±çƒé¾å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'æª¸æª¬å››å­£æ˜¥å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'ç†±å¸¶é†‡é¦™ç´…èŒ¶å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]},
                {name: 'ç´…ç‰é†‡é¦™ç´…èŒ¶å¥¶éœœ', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 55}]}
            ],
            'æ‰¾å£æ„Ÿ': [
                {name: 'ç•°æ¼¾å‡é£²', sizes: [{size: 'M', price: 70}, {size: 'L', price: 75}]},
                {name: 'è²´å¦ƒè”æç´…èŒ¶å‡é£²', sizes: [{size: 'M', price: 75}, {size: 'L', price: 80}]},
                {name: 'æ‰‹æ²–ç´«å¥¶å¸«å‡é£²', sizes: [{size: 'M', price: 75}, {size: 'L', price: 80}]}
            ],
            'æ¸…çˆ½å¾®é…¸æ‰“': [
                {name: 'å†°é®è˜‹æœæ°£æ³¡é£²', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 75}]},
                {name: 'å†°é®ç™¾é¦™æœæ°£æ³¡é£²', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 75}]},
                {name: 'å†°é®ç¶œåˆè“æœæ°£æ³¡é£²', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 80}]},
                {name: 'å†°é®é³³æœæ°£æ³¡é£²', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 80}]}
            ],
            'å­£ç¯€é™å®š': [
                {name: 'å¤æ„äººæŸ¿æ©˜æ±', sizes: [{size: 'M', price: 49}, {size: 'L', price: 55}]},
                {name: 'è˜‹æœè‚‰æ¡‚ç´…èŒ¶é£²', sizes: [{size: 'M', price: 49}, {size: 'L', price: 55}]},
                {name: 'é‡‘æ¡”æª¸æª¬èœ‚èœœæ°£æ³¡', sizes: [{size: 'M', price: 49}, {size: 'L', price: 55}]},
                {name: 'æš–è–‘æª¸å¥¶(ç†±)', sizes: [{size: 'å–®ä¸€å°ºå¯¸', price: 49}]}
            ]
        };
        
        let orderItemCounter = 0;
        
        function addOrderItem() {
            orderItemCounter++;
            const orderItemsContainer = document.getElementById('orderItems');
            
            const orderItem = document.createElement('div');
            orderItem.className = 'order-item';
            orderItem.id = `orderItem_${orderItemCounter}`;
            
            orderItem.innerHTML = `
                <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                    <select id="category_${orderItemCounter}" onchange="updateDrinkOptions(${orderItemCounter})">
                        <option value="">é¸æ“‡åˆ†é¡</option>
                        ${Object.keys(drinkCategories).map(category => 
                            `<option value="${category}">${category}</option>`
                        ).join('')}
                    </select>
                    
                    <select id="drink_${orderItemCounter}" onchange="updateSizeOptions(${orderItemCounter})" disabled>
                        <option value="">è«‹å…ˆé¸æ“‡åˆ†é¡</option>
                    </select>
                    
                    <select id="size_${orderItemCounter}" onchange="updatePrice(${orderItemCounter})" disabled>
                        <option value="">è«‹å…ˆé¸æ“‡é£²æ–™</option>
                    </select>
                    
                    <div class="quantity-control">
                        <button type="button" class="quantity-btn" onclick="changeQuantity(${orderItemCounter}, -1)">âˆ’</button>
                        <input type="number" class="quantity-input" id="quantity_${orderItemCounter}" 
                               value="1" min="1" max="50" onchange="updatePrice(${orderItemCounter})">
                        <button type="button" class="quantity-btn" onclick="changeQuantity(${orderItemCounter}, 1)">+</button>
                    </div>
                    
                    <div class="price-display" id="price_${orderItemCounter}">$0</div>
                    
                    <button type="button" class="remove-btn" onclick="removeOrderItem(${orderItemCounter})">Ã—</button>
                </div>
                
                <!-- å€‹åˆ¥å®¢è£½åŒ–é¸é … -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 10px;">
                    <div style="display: flex; flex-direction: column;">
                        <label style="font-size: 0.9em; font-weight: bold; color: #666; margin-bottom: 5px;">â„ï¸ å†°å¡Šç¨‹åº¦</label>
                        <select id="ice_${orderItemCounter}" style="font-size: 0.9em;" onchange="updateSummary()">
                            <option value="æ­£å¸¸å†°">æ­£å¸¸å†°</option>
                            <option value="å°‘å†°">å°‘å†°</option>
                            <option value="å¾®å†°">å¾®å†°</option>
                            <option value="å»å†°">å»å†°</option>
                            <option value="ç†±é£²">ç†±é£²</option>
                        </select>
                    </div>
                    <div style="display: flex; flex-direction: column;">
                        <label style="font-size: 0.9em; font-weight: bold; color: #666; margin-bottom: 5px;">ğŸ¯ ç³–åˆ†ç¨‹åº¦</label>
                        <select id="sugar_${orderItemCounter}" style="font-size: 0.9em;" onchange="updateSummary()">
                            <option value="æ­£å¸¸ç³–">æ­£å¸¸ç³–</option>
                            <option value="å°‘ç³–">å°‘ç³–</option>
                            <option value="åŠç³–">åŠç³–</option>
                            <option value="å¾®ç³–">å¾®ç³–</option>
                            <option value="ç„¡ç³–">ç„¡ç³–</option>
                        </select>
                    </div>
                    <div style="display: flex; flex-direction: column;">
                        <label style="font-size: 0.9em; font-weight: bold; color: #666; margin-bottom: 5px;">ğŸ¥› å¥¶é‡ç¨‹åº¦</label>
                        <select id="milk_${orderItemCounter}" style="font-size: 0.9em;" onchange="updateSummary()">
                            <option value="æ­£å¸¸å¥¶">æ­£å¸¸å¥¶</option>
                            <option value="å°‘å¥¶">å°‘å¥¶</option>
                            <option value="å¤šå¥¶">å¤šå¥¶</option>
                            <option value="æ¿ƒå¥¶">æ¿ƒå¥¶</option>
                            <option value="ç„¡å¥¶">ç„¡å¥¶</option>
                        </select>
                    </div>
                </div>
            `;
            
            orderItemsContainer.appendChild(orderItem);
            updateSummary();
        }
        
        function updateDrinkOptions(itemId) {
            const categorySelect = document.getElementById(`category_${itemId}`);
            const drinkSelect = document.getElementById(`drink_${itemId}`);
            const sizeSelect = document.getElementById(`size_${itemId}`);
            const priceDisplay = document.getElementById(`price_${itemId}`);
            
            const selectedCategory = categorySelect.value;
            
            drinkSelect.innerHTML = '<option value="">é¸æ“‡é£²æ–™</option>';
            sizeSelect.innerHTML = '<option value="">è«‹å…ˆé¸æ“‡é£²æ–™</option>';
            sizeSelect.disabled = true;
            priceDisplay.textContent = '$0';
            
            if (selectedCategory && drinkCategories[selectedCategory]) {
                drinkSelect.disabled = false;
                drinkCategories[selectedCategory].forEach(drink => {
                    drinkSelect.innerHTML += `<option value="${drink.name}">${drink.name}</option>`;
                });
            } else {
                drinkSelect.disabled = true;
            }
            
            updateSummary();
        }
        
        function updateSizeOptions(itemId) {
            const categorySelect = document.getElementById(`category_${itemId}`);
            const drinkSelect = document.getElementById(`drink_${itemId}`);
            const sizeSelect = document.getElementById(`size_${itemId}`);
            const priceDisplay = document.getElementById(`price_${itemId}`);
            
            const selectedCategory = categorySelect.value;
            const selectedDrink = drinkSelect.value;
            
            sizeSelect.innerHTML = '<option value="">é¸æ“‡å°ºå¯¸</option>';
            priceDisplay.textContent = '$0';
            
            if (selectedCategory && selectedDrink && drinkCategories[selectedCategory]) {
                const drink = drinkCategories[selectedCategory].find(d => d.name === selectedDrink);
                if (drink) {
                    sizeSelect.disabled = false;
                    drink.sizes.forEach(sizeInfo => {
                        sizeSelect.innerHTML += `<option value="${sizeInfo.size}" data-price="${sizeInfo.price}">${sizeInfo.size} - $${sizeInfo.price}</option>`;
                    });
                }
            } else {
                sizeSelect.disabled = true;
            }
            
            updateSummary();
        }
        
        function updatePrice(itemId) {
            const sizeSelect = document.getElementById(`size_${itemId}`);
            const priceDisplay = document.getElementById(`price_${itemId}`);
            const quantityInput = document.getElementById(`quantity_${itemId}`);
            
            const selectedOption = sizeSelect.options[sizeSelect.selectedIndex];
            const price = selectedOption ? parseInt(selectedOption.dataset.price) || 0 : 0;
            const quantity = parseInt(quantityInput.value) || 1;
            
            priceDisplay.textContent = `$${price * quantity}`;
            updateSummary();
        }
        
        function changeQuantity(itemId, change) {
            const quantityInput = document.getElementById(`quantity_${itemId}`);
            let newQuantity = parseInt(quantityInput.value) + change;
            newQuantity = Math.max(1, Math.min(50, newQuantity));
            quantityInput.value = newQuantity;
            updatePrice(itemId);
        }
        
        function removeOrderItem(itemId) {
            const orderItem = document.getElementById(`orderItem_${itemId}`);
            orderItem.remove();
            updateSummary();
        }
        
        function updateSummary() {
            const orderSummary = document.getElementById('orderSummary');
            const totalPrice = document.getElementById('totalPrice');
            const submitBtn = document.getElementById('submitBtn');
            
            let summaryHTML = '';
            let total = 0;
            let hasValidItems = false;
            
            const orderItems = document.querySelectorAll('[id^="orderItem_"]');
            orderItems.forEach(item => {
                const itemId = item.id.split('_')[1];
                const categorySelect = document.getElementById(`category_${itemId}`);
                const drinkSelect = document.getElementById(`drink_${itemId}`);
                const sizeSelect = document.getElementById(`size_${itemId}`);
                const quantityInput = document.getElementById(`quantity_${itemId}`);
                
                if (categorySelect && drinkSelect && sizeSelect && quantityInput) {
                    const category = categorySelect.value;
                    const drink = drinkSelect.value;
                    const size = sizeSelect.value;
                    const quantity = parseInt(quantityInput.value) || 0;
                    
                    if (category && drink && size && quantity > 0) {
                        const selectedOption = sizeSelect.options[sizeSelect.selectedIndex];
                        const price = parseInt(selectedOption.dataset.price) || 0;
                        const itemTotal = price * quantity;
                        
                        const iceSelect = document.getElementById(`ice_${itemId}`);
                        const sugarSelect = document.getElementById(`sugar_${itemId}`);
                        const milkSelect = document.getElementById(`milk_${itemId}`);
                        
                        const ice = iceSelect ? iceSelect.value : 'æ­£å¸¸å†°';
                        const sugar = sugarSelect ? sugarSelect.value : 'æ­£å¸¸ç³–';
                        const milk = milkSelect ? milkSelect.value : 'æ­£å¸¸å¥¶';
                        
                        summaryHTML += `
                            <div class="summary-item" style="flex-direction: column; align-items: flex-start;">
                                <div style="display: flex; justify-content: space-between; width: 100%;">
                                    <span>${drink} (${size}) Ã— ${quantity}</span>
                                    <span>$${itemTotal}</span>
                                </div>
                                <div style="font-size: 0.8em; color: rgba(255,255,255,0.8); margin-top: 5px;">
                                    ${ice} | ${sugar} | ${milk}
                                </div>
                            </div>
                        `;
                        
                        total += itemTotal;
                        hasValidItems = true;
                    }
                }
            });
            
            if (!hasValidItems) {
                summaryHTML = '<div style="text-align: center; opacity: 0.7;">å°šæœªé¸æ“‡ä»»ä½•é£²æ–™</div>';
                submitBtn.disabled = true;
            } else {
                submitBtn.disabled = false;
            }
            
            orderSummary.innerHTML = summaryHTML;
            totalPrice.textContent = `ç¸½è¨ˆï¼š$${total}`;
        }
        
        async function submitOrder() {
            const customerName = document.getElementById('customerName').value.trim();
            const customerContact = document.getElementById('customerContact').value.trim();
            const customerNotes = document.getElementById('customerNotes').value.trim();
            
            if (!customerName || !customerContact) {
                alert('è«‹å¡«å¯«è¨‚è³¼è€…å§“åå’Œè¯çµ¡æ–¹å¼ï¼');
                return;
            }
            
            let orderItems = [];
            let totalPrice = 0;
            let totalQuantity = 0;
            let detailedItems = [];
            
            const orderItemElements = document.querySelectorAll('[id^="orderItem_"]');
            orderItemElements.forEach(item => {
                const itemId = item.id.split('_')[1];
                const categorySelect = document.getElementById(`category_${itemId}`);
                const drinkSelect = document.getElementById(`drink_${itemId}`);
                const sizeSelect = document.getElementById(`size_${itemId}`);
                const quantityInput = document.getElementById(`quantity_${itemId}`);
                const iceSelect = document.getElementById(`ice_${itemId}`);
                const sugarSelect = document.getElementById(`sugar_${itemId}`);
                const milkSelect = document.getElementById(`milk_${itemId}`);
                
                if (categorySelect && drinkSelect && sizeSelect && quantityInput) {
                    const category = categorySelect.value;
                    const drink = drinkSelect.value;
                    const size = sizeSelect.value;
                    const quantity = parseInt(quantityInput.value) || 0;
                    
                    if (category && drink && size && quantity > 0) {
                        const selectedOption = sizeSelect.options[sizeSelect.selectedIndex];
                        const price = parseInt(selectedOption.dataset.price) || 0;
                        const itemTotal = price * quantity;
                        
                        const ice = iceSelect ? iceSelect.value : 'æ­£å¸¸å†°';
                        const sugar = sugarSelect ? sugarSelect.value : 'æ­£å¸¸ç³–';
                        const milk = milkSelect ? milkSelect.value : 'æ­£å¸¸å¥¶';
                        
                        orderItems.push(`${drink} (${size}) Ã— ${quantity} = $${itemTotal}`);
                        detailedItems.push(`${drink} (${size}) Ã— ${quantity} [${ice}|${sugar}|${milk}] = $${itemTotal}`);
                        totalPrice += itemTotal;
                        totalQuantity += quantity;
                    }
                }
            });
            
            if (orderItems.length === 0) {
                alert('è«‹è‡³å°‘é¸æ“‡ä¸€ç¨®é£²æ–™ï¼');
                return;
            }
            
            const orderSummary = detailedItems.join('\\n');
            const confirmMsg = `ğŸ“‹ è¨‚å–®ç¢ºèª\\n\\nğŸ‘¤ è¨‚è³¼è€…ï¼š${customerName}\\nğŸ“± è¯çµ¡æ–¹å¼ï¼š${customerContact}\\n\\nğŸ›’ è¨‚è³¼å…§å®¹ï¼š\\n${orderSummary}\\n\\nğŸ”¢ ç¸½æ•¸é‡ï¼š${totalQuantity} æ¯\\nğŸ’° ç¸½é‡‘é¡ï¼š$${totalPrice}\\nğŸ“ å‚™è¨»ï¼š${customerNotes || 'ç„¡'}\\n\\nç¢ºèªé€å‡ºè¨‚å–®ï¼Ÿ`;
            
            if (confirm(confirmMsg)) {
                const submitBtn = document.getElementById('submitBtn');
                submitBtn.disabled = true;
                submitBtn.textContent = 'ğŸš€ è¨‚å–®æäº¤ä¸­...';
                
                try {
                    await submitToGoogleSheets(customerName, customerContact, detailedItems, totalQuantity, totalPrice, customerNotes);
                    alert('âœ… è¨‚å–®é€å‡ºæˆåŠŸï¼\\n\\nè«‹ç­‰å€™é€šçŸ¥å–è²¨ã€‚');
                    resetForm();
                } catch (error) {
                    console.error('æäº¤éŒ¯èª¤:', error);
                    alert('âŒ è¨‚å–®æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯çµ¡ç®¡ç†å“¡ã€‚');
                } finally {
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ğŸš€ é€å‡ºåœ˜è³¼è¨‚å–®';
                }
            }
        }
        
        async function submitToGoogleSheets(customerName, customerContact, detailedItems, totalQuantity, totalPrice, customerNotes) {
            const webAppUrl = 'https://script.google.com/macros/s/AKfycbx_BtLa0cxJHnaEsBPShkppIEVaTYnJd0uTSqEmXtkZrV7H8jun89lZoQGNUwh43-u0nQ/exec';
            
            // ä½¿ç”¨ FormData è€Œé JSONï¼Œé¿å… CORS å•é¡Œ
            const formData = new FormData();
            formData.append('customerName', customerName);
            formData.append('customerContact', customerContact);
            formData.append('detailedItems', detailedItems.join('\\n'));
            formData.append('totalQuantity', totalQuantity.toString());
            formData.append('totalPrice', totalPrice.toString());
            formData.append('customerNotes', customerNotes || '');
            
            console.log('æäº¤è¨‚å–®è³‡æ–™:', {
                customerName, customerContact, 
                detailedItems: detailedItems.join('\\n'),
                totalQuantity, totalPrice, customerNotes
            });
            
            try {
                const response = await fetch(webAppUrl, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                console.log('æäº¤çµæœ:', result);
                
                if (!result.success) {
                    throw new Error(result.message);
                }
                
                return result;
                
            } catch (error) {
                // CORS éŒ¯èª¤æ˜¯æ­£å¸¸çš„ï¼Œä½†è³‡æ–™å·²ç¶“æˆåŠŸæäº¤
                console.log('æäº¤å®Œæˆï¼ˆå¿½ç•¥ CORS è­¦å‘Šï¼‰:', error.message);
                
                // å› ç‚ºå¯¦éš›æ¸¬è©¦ç¢ºèªè³‡æ–™æœƒæˆåŠŸå¯«å…¥ï¼Œæ‰€ä»¥å›å‚³æˆåŠŸ
                return {
                    success: true,
                    message: 'è¨‚å–®å·²æˆåŠŸé€å‡ºï¼'
                };
            }
        }
        
        function resetForm() {
            document.getElementById('customerName').value = '';
            document.getElementById('customerContact').value = '';
            document.getElementById('customerNotes').value = '';
            
            document.getElementById('orderItems').innerHTML = '';
            orderItemCounter = 0;
            
            addOrderItem();
            updateSummary();
        }
        
        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            addOrderItem();
        });
    </script>
</body>
</html>