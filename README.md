# 🧋 MAYI 滿溢茶飲 - 公司團購系統

一個專為公司團購設計的飲料訂購系統，支援個別客製化選項和自動統計功能。

## ✨ 主要特色

- 📱 **友好的網頁界面** - 簡潔直觀的訂購流程
- 🎯 **精確的飲料分類** - 依照 MAYI 原始菜單分類
- ⚙️ **個別客製化** - 每杯飲料可單獨設定冰塊、糖分、奶量（3-8級）
- 📊 **自動計算** - 即時計算總數量和總金額
- 📋 **直接統計** - 訂單直接寫入 Google Sheets
- 🔄 **用戶友好** - 成功提交後自動清空表單

## 🏗️ 系統架構

```
用戶界面 (HTML/CSS/JS)
        ↓
Google Apps Script Web App
        ↓
Google Sheets 統計表
```

## 安裝步驟

### 1. 建立 Google Apps Script 專案

1. 前往 [Google Apps Script](https://script.google.com)
2. 點選「新增專案」
3. 將 `Code.gs` 內容複製到編輯器中
4. 儲存專案 (命名為「MAYI滿溢茶飲訂購系統」)

### 2. 執行初始設定

1. 在 Google Apps Script 編輯器中
2. 選擇函數 `createDrinkOrderForm`
3. 點選「執行」按鈕
4. 首次執行需授權權限
5. 執行完成後，查看日誌取得表單和試算表連結

### 3. 更新店家聯絡電話

在 `Code.gs` 第 112 行，將「請提供店家電話」改為實際電話號碼：

```javascript
'請提供店家電話', // 改為實際電話，例如：'02-1234-5678'
```

## 菜單內容

### 找奶茶系列 (M/L尺寸)
- 可可風味奶茶：M$50 / L$60
- 仙草凍奶茶：$50
- 茉莉奶綠：M$45 / L$50
- 滿溢烤香奶茶：M$50 / L$55
- 滿溢珍珠奶茶：M$50 / L$55
- 炭燒烏龍奶茶：M$50 / L$55
- 布丁伯爵奶茶：M$50 / L$60
- 可可環果奶：M$60 / L$65
- 手炒黑糖鐵觀音奶：M$60 / L$75

### 找烏味系列 (單一尺寸 $55)
- 嚴選雲南昆明茶
- 茉莉原萃綠茶奶霜
- 蜜柚高麗綠茶奶霜
- 炭焙高山烏龍奶霜
- 檸檬四季春奶霜
- 熱帶醇香紅茶奶霜
- 紅玉醇香紅茶奶霜

### 找口感系列 (M/L尺寸)
- 異漾凍飲：M$70 / L$75
- 貴妃荔枝紅茶凍飲：M$75 / L$80
- 手沖紫奶師凍飲：M$75 / L$80

### 清爽微酸打系列 (單一尺寸)
- 冰鎮蘋果氣泡飲：$75
- 冰鎮百香果氣泡飲：$75
- 冰鎮綜合莓果氣泡飲：$80
- 冰鎮鳳果氣泡飲：$80

### 季節限定 (M/L尺寸)
- 古意人柿橘汁：M$49 / L$55
- 蘋果肉桂紅茶飲：M$49 / L$55
- 金桔檸檬蜂蜜氣泡：M$49 / L$55
- 暖薑檸奶(熱)：$49

## 統計表欄位

Google Sheet 會自動建立包含以下欄位的統計表：

| 欄位 | 說明 |
|------|------|
| 店名 | MAYI 滿溢茶飲 |
| 聯絡電話 | 店家聯絡電話 |
| 訂購時間 | 系統自動記錄 |
| 客戶姓名 | 客戶填寫 |
| 客戶電話 | 客戶填寫 |
| 取餐時間 | 客戶填寫 |
| 訂購清單 | 自動整理所有訂購項目 |
| 總價格 | 自動計算 |

## 使用流程

1. **客戶訂購**：透過 Google Form 填寫訂購資訊
2. **自動處理**：GAS 自動處理表單資料
3. **統計更新**：訂單自動寫入 Google Sheet
4. **查看統計**：店家可隨時查看訂單統計表

## 進階功能

### 1. 客製化修改

- 修改菜單項目：在 `Code.gs` 的 `createDrinkOrderForm()` 函數中調整
- 調整價格：修改對應的價格字串
- 新增欄位：使用 `form.addTextItem()` 等方法

### 2. 通知功能

系統已預留 email 通知功能，若需啟用：

1. 在表單中新增「Email」欄位
2. 取消 `sendConfirmationEmail()` 函數中的註解
3. 客戶將收到訂購確認信

### 3. 資料匯出

Google Sheet 支援匯出為：
- Excel (.xlsx)
- CSV 
- PDF
- 其他格式

## 注意事項

1. **權限設定**：確保 GAS 有存取 Forms 和 Sheets 的權限
2. **表單設定**：表單需設為「任何人都可填寫」
3. **資料備份**：建議定期備份 Google Sheet 資料
4. **客製需求**：可根據實際需求調整表單欄位和統計項目

## 疑難排解

### Q: 表單提交後沒有資料？
A: 檢查觸發器是否正常設定，執行 `ScriptApp.getProjectTriggers()` 確認

### Q: 價格計算錯誤？
A: 檢查 `extractPrice()` 函數的正規表達式是否正確匹配價格格式

### Q: 統計表格式跑掉？
A: 重新執行 `updateOrderSummary()` 或手動調整欄寬

## 聯絡資訊

如有技術問題或客製需求，請聯絡系統開發者。

---

*此系統使用 Google Apps Script 開發，完全免費且無使用限制。*